!function(t){var e,i;return e=function(i){var n,o;return this.el=i.el,n=i.name,o=i.popupOptions,o=t.extend({forceOpen:!0},o),this.popup=new Popup(this.el,this.name,o),this.name=this.popup.name,this.disabled=!1,this.isOpen=!1,this.attachOpeningEvents(),this.attachMiscEvents(),e.instances[this.name]=this},e.version="3.0.4",e.instances={},e.disableAll=function(){var t,i,n,o;n=e.instances,o=[];for(i in n)t=n[i],o.push(t.disabled=!0);return o},i={isIE:document.all&&!window.atob,isIE11:window.navigator.msPointerEnabled,isMobile:document.documentElement.className.indexOf("mobile")!==-1},e.prototype.open=function(){return this.popup.open(),this.isOpen=!0,this.disabled=!0},e.prototype.close=function(){return this.popup.close(),this.isOpen=!1},e.prototype.emit=function(t){return this.el.trigger(t),this.popup.emit(t)},e.prototype.replaceWith=function(t){return this.popup.replaceWith(t),this.attachMiscEvents()},e.prototype.attachOpeningEvents=function(){if(i.isMobile||t(document).on("mouseleave."+this.name,function(t){return function(e){if(t.disabled||Popup.prototype.isOpen||e.relatedTarget||e.clientY>=window.innerHeight/2)return t.open(),t.emit("mouseopen")}}(this)),!(i.isIE||i.isIE11||i.isMobile||this.disabled||this.isOpen))return window.history.replaceState({id:"exit-init"},"",""),window.history.pushState({id:"exit-control"},"",""),t(window).on("popstate",function(t){return function(e){return!t.disabled&&"state"in window.history&&null!==window.history.state&&"exit-control"!==window.history.state.id?(t.open(),t.emit("historyopen")):window.history.back()}}(this))},e.prototype.attachMiscEvents=function(){return this.el.find(".no").on("click."+this.name,function(t){return function(){t.close();try{return localStorage.setItem("exit_intent-complete","true")}catch(t){}}}(this)),this.el.find(".submit").on("click."+this.name,function(t){return function(){return t.emit("submitted")}}(this)),this.el.find(".step").first().find(".next").on("click."+this.name,function(t){return function(){return t.emit("continued")}}(this))},e.prototype.detachEvents=function(){return this.el.find(".no").off("click."+this.name),this.el.find(".submit").off("click."+this.name),this.el.find(".step").first().find(".next").off("click."+this.name),t(document).off("mouseleave."+this.name)},null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=e:"function"==typeof define&&define.amd?define(["exit-intent"],function(){return e}):window.ExitIntent=e}(jQuery);